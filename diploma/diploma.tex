\documentclass[a4paper, 12pt, titlepage, utf8]{extarticle}
    \usepackage[utf8]{inputenc}
    \usepackage[english,russian]{babel}
    \usepackage[left=3cm,right=2cm,top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
    \usepackage{color}
    \usepackage{amsmath}
    \usepackage{cite}
    \usepackage[pdftex]{graphicx}
    \usepackage{subfig}
    \usepackage{numprint}
    \usepackage{amsthm} % для \pushQED

\graphicspath{{./img/}{../img/}} 
\frenchspacing

\linespread{1.3}                % полуторный интервал

\let\oldsection\section         % каждый раздел с новой страницы
\renewcommand{\section}{\newpage\oldsection}

% обёртка с моими настройками поверх figure:
% \begin{myfigure}{подпись}{fig:label} ... \end{myfigure}
\newenvironment{myfigure}[2]%
{\pushQED{\caption{#1} \label{#2}} % push caption & label
    \begin{figure}[!htb]\centering } %
{  \popQED % pop caption & label
    \end{figure}}

% вставка картинки: \figure[params]{подпись}{file}
% создаёт label вида fig:file
\newcommand{\includefigure}[3][]{
\begin{myfigure}{#2}{fig:#3}
    \includegraphics[#1]{#3}
\end{myfigure}
}

% вставка subfigure внутри myfigure:
% \subfigure[params]{подпись}{file}
\newcommand{\subfigure}[3][]{
\subfloat[#2]{\label{fig:#3}\includegraphics[#1]{#3}}
}

\bibliographystyle{gost780u}

\newcommand{\ruclass}{\textit}
\newcommand{\class}{\textbf}
\newcommand{\module}{\class}
\newcommand{\method}{\textit}

\addto\captionsrussian{
    \renewcommand\contentsname{Содержание}
    % перекрываю \refname, чтобы список литературы сам добавлял себя в оглавление
    \let\oldrefname\refname
    \renewcommand\refname{\addcontentsline{toc}{section}{\oldrefname}\oldrefname}
}

\newcommand{\todo}[1]{\textbf{\textcolor{red}{TODO: #1}}}

\newcommand{\myimage}[2]{   
    \begin{center} \textbf{[картинка]: #1} \textit{#2} \end{center} 
}

\author{А.\,П.\,Кузнецов, кафедра ФТИ ФФ НГУ, гр.\,7312}
\title{Инструменты построения и анализа структурного выравнивания молекул биополимеров для проекта UniPro UGENE}

% TODO:
%	спеллчек
%       одиночный интервал списков
%       висячие строки

\begin{document}

% -------------------- Титульная страница------------------------------
\input{title}

% -------------------- Содержание--------------------------------------
\tableofcontents
\newpage

% -------------------- Введение ---------------------------------------
\section{Введение}	% название данной секции стандартно
Исследования в области биоинформатики приобретают высокую актуальность в наши дни. Современные вычислительные мощности позволяют обрабатывать большие объемы данных характерные для биологических объектов, и выполнять сложные математические расчеты за приемлемое время. Биоинформатика позволяет исследователям эффективно автоматизировать обработку данных, и в ряде случаев решать поставленные задачи аналитически, не прибегая к дорогостоящим и длительным экспериментам.

Одной из важнейших областей исследования в биологии, физиологии и фармацевтике является изучение биологических макромолекулярных структур, в частности белков и нуклеиновых кислот. Свойства и назначение этих соединений во многом определяются их структурой. Поэтому исследование структуры биополимеров позволяет лучше понимать процессы, протекающие в живом организме, находить связи между биологическими объектами и выяснять причины возникновения возможных патологий и заболеваний а значит создавать новые высокоэффективные препараты. Инструменты анализа созданные с помощью вычислительной биологии способствуют достижению этих целей и являются неотъемлемой частью современной науки. Существует множество методов автоматизации анализа структур таких как трехмерная визуализация,  структурное выравнивание, предсказание вторичной и третичной структур белка из кодирующей последовательности, моделирование функциональности и взаимодействия биополимеров и другие.

Необходимым средством анализа биологических структур является инструмент построения структурного выравнивания, позволяющий сравнивать структуры между собой. Целью данной работы является разработка такого инструмента на базе проекта с открытым исходным кодом Unipro UGENE \cite{ugene}. UGENE -- это комплексный инструмент автоматизации биологических исследований, поддерживающий большое количество средств анализа последовательностей ДНК, РНК и аминокислот. UGENE является мультиплатформенным приложением, позволяющим достичь максимальной производительности работы за счет платформо-зависимых оптимизаций и адаптации алгоритмов для выполнения в многопоточных средах. В настоящий момент в UGENE уже реализованы средства визуализации трехмерных структур, а также некоторые базовые методы структурного анализа, таким образом, реализация инструмента построения структурного выравнивания является закономерным шагом в развитии проекта в данной области.

Использование разработанного компонента в совокупности с уже существующим инструментарием UGENE даст возможность эффективней решать сложные многоэтапные задачи, связанные с макромолекулярными структурами, что несомненно повысит результативность работы исследователей в этой области.


% -------------------- Описание предметной области --------------------
\section{Описание предметной области}	% название данной секции стандартно
Анализ макромолекулярных структур это обширная область исследований в современной биологии. Она охватывает большой спектр объектов и явлений и располагает множеством инструментов вычислительной биологии. Ниже речь пойдет о структурном выравнивании, одном из базовых методов анализа структур. Также будет конкретизирован термин <<биологическая макромолекулярная структура>> и рассмотрена база данных PDB, предназначенная для хранения описаний структур.

В рамках этой работы, термин <<биологическая макромолекулярная структура>> рассматривается применительно к белкам, тем не менее, некоторые методы структурного анализа, например, структурное выравнивание, возможно обобщить и для нуклеиновых кислот (ДНК и РНК).

\subsection{Понятие биологической макромолекулярной структуры}
В общем случае биологическая макромолекулярная структура представляет собой набор трехмерных координат образующих её атомов. Эти координаты могут быть получены экспериментально с помощью методов рентгеноскопии и атомной спектроскопии или предсказаны теоретически исходя из кодирующей последовательности с помощью вычислительных алгоритмов. Знание пространственной структуры биополимера необходимо, так как именно от неё в значительной степени зависит функциональное назначение биополимера и проявляемые им свойства. Механика взаимодействия макромолекул тоже во многом определяется их трехмерной структурой и взаимным расположением в пространстве. 

%\includefigure[width=0.5\linewidth]{биоструктура}{alignment-3TRX-vs-1XWC}

Однако, координаты атомов далеко не единственная составляющая макромолекулярной структуры. Принято выделять следующие уровни организации биологической структуры:
\begin{itemize}
    \item \textbf{Первичная структура} или кодирующая последовательность. Первичная структура эквивалентна химической формуле биополимера.
    \item \textbf{Вторичная структура} -- локальные упорядочивания фрагментов главной цепи макромолекулы, стабилизированные преимущественно водородными связями. Вторичная структура полностью задается кодирующей последовательностью.
    \item \textbf{Третичная структура} -- пространственное строение макромолекулы (набор пространственных координат составляющих её атомов). Зависит не только от первичной и вторичной структур но и в больш\'{о}й степени от окружающей среды в которой биополимер синтезирован. 
    \item \textbf{Четвертичная структура} или доменная представляет собой взаимное расположение нескольких макромолекул в составе единого комплекса 
\end{itemize}

Таким образом, биологическая макромолекулярная структура может включать в себя: информацию о кодирующей последовательности, информацию о вторичной структуре и доменах (функциональных областях молекулы), информацию о пространственном строении молекулы, кроме того в понятие структуры включают полный граф химических связей. Дело в том, что граф химических связей, как правило, невозможно восстановить из кодирующей последовательности, из-за т.н. посттрансляционных модификаций. Под воздействием окружающей среды структура и химический состав биополимера могут значительно меняться, в состав белков могут войти нестандартные аминокислоты или другие соединения. Для сохранения этой информации и служит граф химических связей, явно описывающей все соединения между атомами.
 
Дополнительно макромолекулярная структура может содержать различную мета информацию: сведения о том, как структура была получена, описание кристаллографической ячейки, замечания о функциональных особенностях молекулы, ссылки на связанные научные статьи и так далее.

\subsection{База данных биологических структур PDB}
В настоящее время существует несколько общедоступных баз данных, аккумулирующих информацию об известных биологических структурах. Среди них можно выделить Protein Data Base \cite{pdb}, в ней доступны все известные на сегодняшний день структуры (более 70000,  изначально в 1971 году в ней было доступно всего 7 структур). Лаборатории, специализирующиеся на изучении биологических структур, пополняют в первую очередь эту базу данных. 

Данные PDB хранятся в простом текстовом формате. Этот формат получил широкое распространение и является стандартом для инструментов анализа структур, он хорошо подходит для записи результатов структурного выравнивания, о котором пойдет речь ниже.

\subsection{Структурное выравнивание}
Одним из важных направлений анализа трехмерных структур является поиск сходства среди макромолекул. Эта проблема -- прямая аналогия с очень распространенной в биоинформатике задачей поиска схожих последовательностей. Отличие в том, что поиск основан на нахождении общих черт трехмерных моделей. Иными словами структурное выравнивание -- это способ определения степени схожести молекул по их трехмерной структуре.

Задача построения структурного выравнивания в простейшем случае сводится к поиску трансформации \textbf{T}, приводящей к оптимальному наложению. Качество наложения задается метрикой 
\begin{center} $ \operatorname{RMSD}(ref, mob) = \sqrt{ \dfrac{\sum_{i=1}^n \| \mathbf{\bar{x}}_{ref,i} -  \mathbf{\bar{x}}_{mob,i} \| ^2} {n} } $ \end{center}
чем меньше \textbf{RMSD}, тем больше сходство между структурами,  \textbf{RMSD=0}  означает что структуры идентичны.

Как правило, одна структура остается неподвижной (reference) и трансформация вычисляется только для второй, т.н. мобильной (mobile) структуры.

\myimage{Поиск преобразования сдвига/поворота минимизирующего RMSD}{alignment}

Структурное выравнивание является важным инструментом анализа и имеет ряд применений \cite{structural-bionformatics}.
\begin{itemize}
    \item Классификация биополимеров по структурным паттернам и составление библиотек паттернов для последующего аннотирования
    \item Определение функционального назначения белка путем сравнения его структуры со структурой известного белка
    \item Структурное выравнивание может обнаруживать связь между биополимерами, неявную исходя из выравнивания последовательностей 
    \item Методы предсказания структуры для оценки качества результатов требуют сравнения смоделированных структур с заранее известными шаблонами
    \item Структурное выравнивание необходимо как вспомогательный инструмент при конструировании искусственных молекул
\end{itemize}

\paragraph{Входные данные и результат.}
% вход
Алгоритм парного структурного выравнивания на входе принимает две трехмерные структуры. Структура может представлять как всю макромолекулу или являться некоторым участком её цепи. Некоторые методы позволяют выравнивать только участки цепи одинаковой длинны. Выбор оптимальных участков в таком случае становится отдельной задачей, например, он может быть сделан на основе выравнивания последовательностей. Существуют также методы предназначенные только для сравнения структур с идентичными последовательностями, они в первую очередь полезны для сравнения разных конформаций одного и того же биополимера. 

Известно, что молекулы белков представляют собой линейные полимеры, при этом можно выделить основную цепь молекулы и присоединенные к ней боковые цепи (радикалы аминокислот). Существуют различные варианты для выбора подмножества атомов которые будут участвовать в выравнивании и расчете RMSD. При выравнивании структур с сильно различающимися последовательностями, атомы боковых цепей не учитываются. Иначе при расчете RMSD большое число не совпадающих атомов боковых цепей будет преобладать, даже в случае если основные цепи совпадут. По этой причине многие алгоритмы структурного выравнивания по-умолчанию учитывают только атомы основной цепи. Дополнительно, для упрощения вычислений могут учитываться только альфа-атомы углерода, так как координаты альфа-атомов углерода полностью задают структуру основной цепи. Только в случае когда кодирующие последовательности белков обладают высоким сходством или полностью идентичны имеет смысл строить выравнивание с учетом атомов боковых цепей, в таком случае RMSD показывает не только сходство структуры основной цепи но и совпадение положений атомов боковых цепей. Для улучшения результатов выравнивания можно дополнительно учитывать совпадения вторичной структуры, схем водородных, ковалентных и ионных связей и другие факторы \cite{wiki-3}. 

\myimage{Альфа атомы углерода}{c-alpha}

% выход
Результатом работы алгоритма или структурным выравниванием являются преобразованные трехмерные структуры и вычисленное значение RMSD. Вместо преобразованных координат мобильной структуры достаточно рассматривать только матрицу (4$\times$4) задающую преобразование сдвига/поворота. Формат PDB позволяет записать обе структуры, reference и mobile, в один файл, что делает его удобным для хранения структурного выравнивания.

\paragraph{Связь с выравниванием последовательностей.}
Наряду с методами, опирающихся исключительно на информацию о трехмерной структуре, существуют подходы учитывающие также информацию о кодирующей последовательности. Первым шагом работы таких алгоритмов является построение выравнивания последовательностей. Наличие такого выравнивания позволяет выделить участки молекулярных цепей, где последовательности похожи или идентичны, и рассматривать в дальнейшем только эти участки при сравнении структур. Имеет место и обратная задача -- построение выравнивания последовательностей по известному наложению структур.

\paragraph{Алгоритмическая сложность.}
Не смотря на то, что некоторые близкие проблемы структурной биоинформатики являются NP-полными, для задачи структурного выравнивания NP-полнота не доказана. Более того, точное решение известно для некоторых специальных метрик GDT\_TS \cite{wiki-2} и MaxSub \cite{wiki-11}. Но практическое применение точных алгоритмов использующих эти метрики не целесообразно из-за все еще большой вычислительной сложности, которая, зависит не только от размера входных структур, но и от их строения  \cite{wiki-12}. Большинство методов полагаются на эвристические алгоритмы.

\paragraph{Визуализация структурного выравнивания.}
Трехмерная визуализация является естественным способом представления структурного выравнивания. Она преследует те же цели что и трехмерная визуализация макромолекулярных структур. Прежде всего, она позволяет нагляднее представлять громоздкие химические формулы соответствующие сложным соединениям. Визуализация помогает увидеть новые особенности исследуемых структур или закономерности в строении биополимера. Еще одним важным применением визуализации является использование изображений в научных публикациях и образовательных ресурсах с целью демонстрации свойств биологического объекта или в виде пояснения для идей и выводов.


% -------------------- Обзор существующих решений----------------------
\section{Обзор существующих решений}
На данный момент существует широкий ряд программных продуктов позволяющих решать различные задачи в области автоматизации анализа и визуализации биологических макромолекулярных структур. Разработано большое количество алгоритмов выравнивания структур реализующих различные подходы. Многие из этих реализаций представлены только в виде веб-сервисов. Значительным недостатком таких решений является большое время выполнения анализа, это создает определенные неудобства и делает невозможным многократный запуск выравниваний. Гораздо меньшее количество программ позволяют выполнять выравнивание локально и использовать этот инструмент в совокупности с другими видами анализа. В этом разделе кратко рассмотрены наиболее эффективные и широко используемые из таких решений.

% --- The Swiss Institute of Bioinformatics Swiss-PdbViewer (Deep View) ---
\paragraph{Swiss-PdbViewer (Deep View) \cite{deep-view}}
приложение с дружественным графическим интерфейсом. Включающее широкий спектр средств анализа и визуализации биологических структур. В том числе и несколько инструментов сравнения структур:
\begin{itemize}
    \item \textbf{Magic Fit} производит наложение структур на основе выравнивания последовательностей.
    \item \textbf{Iterative Magic Fit} производит наложение структур с помощью \textbf{Magic Fit}, и затем выполняет оптимизацию RMSD.
    \item \textbf{Explore Domain Alternate Fits} вычисляет структурное выравнивание учитывая при этом только третичную структуру.
\end{itemize}

Среди особенностей можно отметить возможность выравнивать с помощью инструментов Magic Fit и Iterative Magic Fit модели состоящие из нескольких цепей и визуализацию с применением специальной цветовой схемы, где интенсивность цвета зависит от величины расхождения молекулярных цепочек.

Недостатком является отсутствие поддержки Linux платформ.

% --- UCSF Chimera  ---
\paragraph{UCSF Chimera \cite{chimera}}
кроссплатформенный инструмент визуализации биологических структур, реализованный на языке Python. Наряду с визуализацией предоставляет некоторые возможности анализа структур. Построение структурного выравнивания производится в два этапа: сначала производится выравнивание последовательностей, а затем на основе него выполняется наложение трехмерных структур \cite{chimera-alignment}. При этом, могут учитываться особенности вторичной структуры. Есть возможность решать обратную задачу: вычислять выравнивание последовательностей по существующему выравниванию структур.

% --- PyMOL ---
\paragraph{PyMOL \cite{pymol}}
программа на языке Python, предназначенная для визуализации биологических структур, с возможностью строить наложение трехмерных структур через выравнивание последовательностей. При визуализации выравнивания может быть использована цветовая схема, в которой цветом обозначена величина расхождения молекулярных цепочек. Несмотря на то, что программа имеет графический интерфейс, выполнения выравнивания возможно только через текстовую консоль, или посредством написания скрипта.
 
\paragraph{}
Веб-сервисы построения структурного выравнивания \textbf{FAST} и \textbf{MultiProt} предоставляют для загрузки дистрибутивы программ, которые могут быть использованы для построения выравнивания на локальной машине. Эти программы предназначены только для структурного выравнивания и требуют использования сторонних пакетов для визуализации. Для таких решений характерно отсутствие поддержки операционной системы Microsoft Windows.


% -------------------- Постановка задачи ------------------------------
\section{Постановка задачи}	% название данной секции стандартно

\subsection{Анализ существующих решений}
Вышеперечисленные решения в области анализа и визуализации биологических макромолекулярных структур (см. раздел 3) имеют ряд недостатков. Условно можно разделить все решения на две категории: специализированные на построении структурного выравнивания, и универсальные инструменты структурного анализа, в которых имеется подобная функциональность. Для первых характерны отсутствие интеграции с другими инструментами и, как следствие, невозможность протяжки результатов алгоритма для дальнейшего анализа, для вторых -- концентрация внимания только на трехмерной модели и слабая связь с биологической последовательностью, являющейся основой структуры. К общим недостаткам можно отнести неудобный визуальный пользовательский интерфейс или его отсутствие, невысокая производительность решений, реализованных на интерпретируемых языках и ограниченная поддержка платформ у нативных решений.

Реализация инструмента построения выравнивания биологических структур на базе платформы Unipro UGENE позволит преодолеть эти недостатки.

\subsection{Цели и задачи работы}
Целью дипломной работы является создание программного компонента, позволяющего автоматизировать и упростить процесс построения структурного выравнивания биологических макромолекулярных структур и интеграция этого инструментария с системой Unipro UGENE.

Созданный набор компонентов должен обеспечить:
\begin{itemize}
    \item \textbf{Инструмент построения структурного выравнивания} на базе актуального алгоритма.

    \item \textbf{Графический интерфейс пользователя.} Дружественный графический интерфейс должен способствовать эффективному решению задач стоящих перед исследователем.

    \item \textbf{Интеграцию} компонента с существующими инструментами анализа UGENE. 

    \item \textbf{Трехмерную визуализацию структурного выравнивания.} Существующий модуль \module{BioStruct3DView} должен быть доработан для отображения выравниваний. Необходимо иметь возможность выводить одновременно несколько структур, гибко управлять параметрами отображения молекул. Необходимо добавить специальную цветовую схему, которая сделает визуализацию более наглядной.

    \item \textbf{Переносимость и производительность.} Под переносимостью понимается возможность работы программы на широком спектре различных платформ. Производительность набора программных модулей должна быть не ниже чем производительность существующих решений и реализаций методов анализа.

    \item \textbf{Базу для будущего развития} и добавления новых возможностей. Сюда входит добавление новых алгоритмов выравнивания, улучшение визуализации, интеграцию с внешними инструментами путем реализации импорта и экспорта выравниваний и другие задачи.

    \item \textbf{Тестовую базу}, которая гарантирует корректность работы разработанного компонента.
\end{itemize}


% -------------------- Реализация -------------------------------------
\section{Реализация}
\subsection{Внутреннее представление данных UGENE}
В UGENE существует модель данных для представления биологической макромолекулярной структуры \class{BioStruct3D}. Эта модель разработана так, чтобы включать все данные о молекулярной структуре необходимые для её анализа.

\myimage{Модель данных для описания биологической макромолекулярной структуры}{biostruct\_3d}

В модель данных макромолекулярной структуры (\class{BioStruct3D}) входят следующие базовые компоненты:
\begin{itemize}
    \item \textbf{pdbID} идентификатор биополимера в базе данных PDB 
    \item \textbf{AtomSetMap} набор коллекций описаний атомов, составляющих структуру
    \item \textbf{MoleculeMap} набор графов химических связей биополимера 
    \item \textbf{SecondaryStructureMap} набор описаний вторичной структуры
\end{itemize}

Инструментам анализа UGENE не требуются сведения о том, каким образом создана структура: загружена ли она из файла, базы данных, или смоделирована в ходе работы одного из методов анализа структуры. Модель не зависит от какого-либо конкретного файлового формата  благодаря абстракциям \class{Document} и \class{DocumentFormat}. \ruclass{Документ} предоставляет доступ к некоторому набору объектов, которыми оперирует система. Такими объектами являются, например, биологическая структура \\ (\class{BioStruct3DObject}) или биологическая последовательность (\class{SequenceObject}). 

\myimage{Модель документа}{document\_model}

Конкретные реализации интерфейса \class{DocumentFormat} отвечают за поддержку соответствующих файловых форматов. Это решение позволяет добавлять поддержку новых форматов не затрагивая при этом внутреннею модель. В UGENE поддерживаются чтение форматов биологических структур PDB и MMDB.

Эта модель была доработана, с целью иметь возможность выполнять трехмерные преобразования структуры, и использована в работе.

\subsection{Подмножество макромолекулы BioStruct3DSubset}
Для построения структурного выравнивания важно наличие возможности указать регион молекулярной цепи, на котором оно будет выполняться. BioStruct3D не обеспечивает подобной функциональности, поэтому был добавлен тип \class{BioStruct3DSubset}, представляющий из себя ссылку на подмножество структуры.
\myimage{BioStruct3DSubset}{biostruct\_3d\_subset}

В него входят следующие компоненты:
\begin{itemize}
    \item \textbf{biostruct}  ссылка на полную структуру 
    \item \textbf{chains} список ID молекулярных цепей 
    \item \textbf{chainRegin} регион молекулярной цепи (для случая когда задана одна цепь)
    \item \textbf{modelId} используемая модель
\end{itemize}

Также реализован элемент графического интерфейса, позволяющий пользователю задавать регион.
\myimage{BioStruct3DSubset editor GUI}{subset-editor}

\subsection{Интерфейс алгоритма выравнивания}
В результате анализа задачи, был выделен минимальный достаточный интерфейс алгоритма парного структурного выравнивания. 

\myimage{StructuralAlignmentAlgorithm}{structural\_alignment\_algorithm}
Выравнивание выполняется с помощью вызова \method{align()}, он принимает на входе ссылки на два описания структуры \class{BioStruct3DSubset} и возвращает в результате экземпляр \class{StructuralAlignment}, содержащий рассчитанные матрицу трансформации и RMSD. 

Метод \method{validate()} позволяет быстро проверить входные данные на соответствие ограничениям конкретного метода выравнивания. Это позволяет предупредить пользователя о некорректных параметрах непосредственно на этапе их ввода.

Реализации интерфейса \class{StructuralAlignmentAlgorithm} должны помещаться в подключаемых модулях на базе интерфейса \class{Plugin}, предусмотренного в UGENE. При загрузке подключаемый модуль регистрирует реализацию алгоритма в специальном реестре, откуда он в последствии может быть получен. Таким образом, возможно добавление поддержки новых алгоритмов.

\subsection{Интерфейс вычислительной задачи UGENE Task}
Каждый отдельный алгоритм или его независимая часть базируется на интерфейсе \class{Task} существующем в UGENE. Интерфейс \class{Task} используется для описания некоторого независимого процесса или действия внутри системы. Выполнением этих действий управляет менеджер задач UGENE. Такой подход обеспечивает унификацию и, в ряде случаев, позволяет легко распараллелить выполнение программы.

\myimage{StructuralAlignmentTask}{structural\_alignment\_task}

\subsection{Библиотека PTools}
Реализация самого алгоритма с нуля не имеет смысла, так как на данный момент существует множество готовых библиотек и инструментов поддерживающих эти функции. Причем, часть из них имеют открытый исходный код. Было решено выбрать одну из таких библиотек, отвечающую следующим требованиям:

\begin{itemize}
    \item Актуальность и эффективность алгоритма
    \item Доступный исходный код и лицензия совместимая с GPLv2 \cite{gpl}
    \item Код на языках C/С++
    \item Переносимость: должны поддерживаться платформы Microsoft Windows, Linux и Mac, как 32 так и 64 разрядные
    \item Гибкость и высокий потенциал развития
    \item Наличие документации
\end{itemize}

В итоге была выбрана библиотеке докинга PTools \cite{ptools}, в которой имеется возможность наложения структур. 

Для встраивания в UGENE код библиотеки был существенно переработан. Модули разделены, оставлены только те из них которые непосредственно используются алгоритмом выравнивания. Код адаптирован для библиотеки Qt и системы сборки qmake. Участки кода, использующие нестандартные расширения GCC, переписаны, чтобы обеспечить совместимость с компилятором MSVC.

Внутренняя модель данных библиотеки для представления макромолекулярной структуры значительно отличается от модели существующей в UGENE, что делает невозможным использование \class{BioStruct3D} и \class{BioStruct3DSubset} напрямую. Для решения этой проблемы был разработан адаптер, который осуществляет преобразование из одного внутреннего формата в другой. Следует отметить, что конвертация требуется только для входных структур, так как рассчитанная в результате работы выравнивания матрица трансформации может быть без проблем применена к \class{BioStruct3D} напрямую.

Код библиотеки вместе с реализацией интерфейса \class{StructuralAlignmentAlgorithm} размещен в подключаемом модуле \module{PTools}, который, в свою очередь включен в дистрибутив UGENE.

\subsection{Визуализация выравнивания}
Визуализация структурного выравнивания реализована на базе ранее существовавшего компонента UGENE \module{BioStruct3DView}. Этот инструмент предоставляет широкие возможности визуализации биоструктур. Однако, изначально BioStruct3DView не предназначен для визуализации выравниваний. Для этой задачи прежде всего необходима возможность размещать несколько трехмерных структур в одной сцене, а также гибко управлять параметрами отображения для каждой из них, чтобы избежать загромождения итогового изображения. 

Добавление этой функциональности повлекло за собой значительные изменения в BioStruct3DView, так как этот модуль проектировался без учета озвученных требований. Также добавлена новая цветовая схема, улучшающая визуализацию выравнивания; улучшено управление списком отображаемых моделей и отображение выделенных частей молекулы.

\myimage{Структурное выравнивание молекул тиоредоксина человека (3TRX) и чернобрюхой дрозофилы (1XWC)}{alignment-3TRX-vs-1XWC}

\subsection{Тестирование}
Добавленная функциональность была тщательно протестирована. С помощью специального фреймворка, входящего в состав UGENE, были созданы автоматические тесты для алгоритма выравнивания проверяющие корректность его работы и тесты подтверждающие, что изменения в коде библиотеки PTools не влияют на логику её работы и результаты. Кроме того, библиотека PTools изначально поддерживает загрузку файлов формата PDB. Поэтому были добавлены тесты, позволяющие убедиться, что результаты выравнивания не зависят от того какой загрузчик PDB используется будь то встроенный в библиотеку, или загрузчик UGENE вместе с последующим преобразованием из BioStruct3D во внутренний формат PTools. В качестве тестовых данных использовались как специально сгенерированные наборы данных с заранее известными проверенными результатами так и реальные данные из базы данных PDB. Работа компонентов была успешно протестирована на ряде платформ, таких как Microsoft Windows 7 64bit, Linux x86, x86\_64, Mac OS X.

\subsection{Результаты}
В данной работе ставилась цель разработать инструментарий позволяющий выполнять построение и визуализацию структурного выравнивания. Эта цель была достигнута, и были удовлетворены поставленные в разделе 4 требования, включая наглядный пользовательский интерфейс и возможности для дальнейшего расширения функциональности. Более того, были устранены недоработки существовавшего инструмента визуализации BioStruct3DView.

Добавленная функциональность была тщательно протестирована. Созданная тестовая база не только подтверждает, что разработанные компоненты работают корректно, но и позволяет избежать ошибок при внесении улучшений.

На этом развитие разработанного инструмента не прекращается, планируется продолжить работу над ним, а также над реализацией других инструментов структурного анализа, необходимых молекулярным биологам в реальных исследованиях.


% -------------------- Заключение -------------------------------------
\section{Заключение}
В рамках дипломной работы был разработан, реализован и протестирован инструмент для построения структурного выравнивания. Использование разработанного инструментария в совокупности с инструментами UGENE в реальных исследованиях позволит исследователям-биологам упростить и ускорить процесс изучения биологических структур, а также решение других актуальных задач в данной области. При этом сам процесс анализа является интерактивным и легко управляемым благодаря наличию дружелюбного графического пользовательского интерфейса и возможности трехмерной визуализации результатов.

Открытая модель разработки проекта Unipro UGENE, в рамках которого выполнялась данная работа, делает для исследователя возможным расширять функциональность инструментария за счет своих собственных решений. И поэтому, наряду с реализованным алгоритмом выравнивания важным результатом работы также является программный интерфейс, спроектированный с учетом возможности дальнейшего расширения и добавления новых методов анализа в будущем.

В ходе выполнения работы был получен важный разработки масштабных наукоемких программных продуктов. Ключевыми этапами в накоплении опыта было изучение и применение на практике методов биоинформатики, изучение и использование фреймворка Qt, приобщение к открытой модели разработки программного обеспечения, знакомство с принципами мультиплатформенного и параллельного программирования, изучение промышленных методов, используемых в разработке и тестировании программного обеспечения.

Проект UGENE, в рамках которого выполнялась работа, на данный момент продолжает свое развитие. Добавляются новые методы анализа, создаются специализированные платформо-ориентированные оптимизации алгоритмов (GPGPU, кластерные и облачные решения).
Уже сейчас вычислительная платформа UGENE, вместе с разработанным в ее контексте инструментарием входит в состав дистрибутивов двух открытых операционных систем: Ubuntu Linux и Fedora Core.
Исследования, проведенные в рамках данной работы, имеют высокий потенциал для развития и могут служить хорошей базой для дальнейших разработок в области вычислительной структурной биологии.


% -------------------- Список литературы-------------------------------
\begin{flushleft}
    \bibliography{biblio/diploma}
    \nocite{algolist-cgl}           % http://www.cgl.ucsf.edu/home/meng/grpmt/structalign.html
    \nocite{algolist-protopedia}    % http://proteopedia.org/wiki/index.php/Structural\_alignment\_tools

    \vspace{1.5cm}
    Студент 4 курса ФФ НГУ\\
    Кузнецов Алексей Павлович
\end{flushleft}

\end{document}
